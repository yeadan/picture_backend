(function(e){function t(t){for(var n,i,o=t[0],u=t[1],c=t[2],l=0,d=[];l<o.length;l++)i=o[l],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&d.push(a[i][0]),a[i]=0;for(n in u)Object.prototype.hasOwnProperty.call(u,n)&&(e[n]=u[n]);p&&p(t);while(d.length)d.shift()();return s.push.apply(s,c||[]),r()}function r(){for(var e,t=0;t<s.length;t++){for(var r=s[t],n=!0,i=1;i<r.length;i++){var u=r[i];0!==a[u]&&(n=!1)}n&&(s.splice(t--,1),e=o(o.s=r[0]))}return e}var n={},a={app:0},s=[];function i(e){return o.p+"js/"+({about:"about"}[e]||e)+"."+{about:"13852189"}[e]+".js"}function o(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.e=function(e){var t=[],r=a[e];if(0!==r)if(r)t.push(r[2]);else{var n=new Promise((function(t,n){r=a[e]=[t,n]}));t.push(r[2]=n);var s,u=document.createElement("script");u.charset="utf-8",u.timeout=120,o.nc&&u.setAttribute("nonce",o.nc),u.src=i(e);var c=new Error;s=function(t){u.onerror=u.onload=null,clearTimeout(l);var r=a[e];if(0!==r){if(r){var n=t&&("load"===t.type?"missing":t.type),s=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+n+": "+s+")",c.name="ChunkLoadError",c.type=n,c.request=s,r[1](c)}a[e]=void 0}};var l=setTimeout((function(){s({type:"timeout",target:u})}),12e4);u.onerror=u.onload=s,document.head.appendChild(u)}return Promise.all(t)},o.m=e,o.c=n,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(r,n,function(t){return e[t]}.bind(null,n));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/",o.oe=function(e){throw console.error(e),e};var u=window["webpackJsonp"]=window["webpackJsonp"]||[],c=u.push.bind(u);u.push=t,u=u.slice();for(var l=0;l<u.length;l++)t(u[l]);var p=c;s.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},"2fc4":function(e,t,r){},"56d7":function(e,t,r){"use strict";r.r(t);r("cadf"),r("551c"),r("f751"),r("097d");var n=r("2b0e"),a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"app"}},[r("HeaderBar"),r("router-view")],1)},s=[],i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.hasUser?r("nav",{staticClass:"navbar docs-navbar is-spaced has-shadow"},[r("div",{staticClass:"navbar-menu"},[r("div",{staticClass:"navbar-end"},[r("div",{staticClass:"navbar-item"},[r("b-button",{attrs:{type:"is-info","icon-left":"cloud-upload-alt"},on:{click:function(t){e.showUploadModal=!0}}},[e._v("\n          Upload\n        ")])],1),r("div",{staticClass:"navbar-item"},[r("b-button",{attrs:{type:"is-danger","icon-left":"sign-out-alt"},on:{click:e.logOut}},[e._v("\n          Log Out\n        ")])],1)])]),r("b-modal",{attrs:{active:e.showUploadModal,"has-modal-card":"","trap-focus":"","aria-role":"dialog","aria-modal":""},on:{"update:active":function(t){e.showUploadModal=t}}},[r("UploadPictureCard")],1)],1):e._e()},o=[],u=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"modal-card"},[e._m(0),r("div",{staticClass:"modal-card-body"},[r("transition",{attrs:{name:"fade"}},[null===e.picture.image?r("b-upload",{key:"uploadPicture",attrs:{"drag-drop":""},model:{value:e.uploadPictureFile,callback:function(t){e.uploadPictureFile=t},expression:"uploadPictureFile"}},[r("section",{staticClass:"section"},[r("div",{staticClass:"content has-text-centered"},[r("p",[r("b-icon",{attrs:{icon:"upload",size:"is-large"}})],1),r("p",[e._v("Drop your JPEG picture here")])])])]):r("div",{key:"detailsPicture",staticClass:"message"},[r("form-wrapper",{attrs:{validator:e.$v.picture}},[r("form",{on:{submit:function(t){return t.preventDefault(),e.createPicture(t)}}},[r("form-group",{attrs:{name:"title",label:"Picture Title"}},[r("b-input",{attrs:{type:"text",placeholder:"Picture Title"},on:{input:function(t){return e.$v.picture.title.$touch()}},model:{value:e.picture.title,callback:function(t){e.$set(e.picture,"title",t)},expression:"picture.title"}})],1),r("form-group",{attrs:{name:"description",label:"Description"}},[r("b-input",{attrs:{type:"textarea",placeholder:"Picture Description"},on:{input:function(t){return e.$v.picture.description.$touch()}},model:{value:e.picture.description,callback:function(t){e.$set(e.picture,"description",t)},expression:"picture.description"}})],1),r("div",{staticClass:"field"},[r("button",{staticClass:"button is-primary is-large is-fullwidth",on:{click:e.createPicture}},[e._v("\n                Create Picture\n              ")])])],1)])],1)],1),r("b-message",{attrs:{type:"is-danger","has-icon":"",size:"small",active:e.pictureError},on:{"update:active":function(t){e.pictureError=t}}},[e._v("\n      "+e._s(e.pictureErrorMessage)+"\n    ")])],1)])},c=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("header",{staticClass:"modal-card-head"},[r("p",{staticClass:"modal-card-title"},[e._v("Upload Picture")])])}],l=(r("28a5"),r("96cf"),r("3b8d")),p=(r("6762"),r("2fdb"),r("b5ae")),d={name:"UploadPictureCard",data:function(){return{uploadPictureFile:null,picture:{image:null,image_id:null,title:null,description:null},pictureError:!1,pictureErrorMessage:null}},watch:{pictureErrorMessage:function(e){this.pictureError=null!==e},uploadPictureFile:function(e){this.pictureErrorMessage=null,e&&e.size>0&&e.type.includes("jpeg")?e.size<2097152?this.picture.image=e:this.pictureErrorMessage="The maximum image size is 2MiB":this.pictureErrorMessage="Please upload a valid JPEG image"}},methods:{createPicture:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){var t,r,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.$v.picture.$touch(),!1!==this.$v.picture.$invalid){e.next=18;break}return e.next=4,this.apiPost("images?type=picture",this.picture.image);case 4:if(t=e.sent,201!==t.status||!t.headers.location){e.next=17;break}return r=t.headers.location.split("/"),n=parseInt(r[r.length-1]),this.picture.image=null,this.picture.image_id=n,this.picture.user_id=parseInt(this.$ls.get("user_id")),e.next=13,this.apiPost("pictures",this.picture);case 13:t=e.sent,201===t.status?this.$eventHub.$emit("picture-created"):this.pictureErrorMessage="Error creating the picture",e.next=18;break;case 17:this.pictureErrorMessage="Error creating the image";case 18:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},validations:{picture:{required:p["required"],title:{required:p["required"],minLength:Object(p["minLength"])(3),maxLength:Object(p["maxLength"])(100)},description:{minLength:Object(p["minLength"])(0),maxLength:Object(p["maxLength"])(2e3)}}}},m=d,h=r("2877"),f=Object(h["a"])(m,u,c,!1,null,null,null),v=f.exports,b={name:"HeaderBar",components:{UploadPictureCard:v},data:function(){return{hasUser:!1,showUploadModal:!1}},mounted:function(){this.$ls.on("token",this.tokenUpdate),this.tokenUpdate(),this.$eventHub.$on("picture-created",this.onPictureCreated),this.$eventHub.$on("login",this.tokenUpdate)},methods:{tokenUpdate:function(){var e=this.$ls.get("token");this.hasUser=e&&e.length>0},logOut:function(){this.$ls.clear(),this.hasUser=!1,this.$router.push({name:"home"})},onPictureCreated:function(){this.showUploadModal=!1,this.$buefy.snackbar.open("New Picture created successfully")}}},g=b,w=Object(h["a"])(g,i,o,!1,null,null,null),x=w.exports,$={components:{HeaderBar:x}},y=$,P=(r("5c0b"),Object(h["a"])(y,a,s,!1,null,null,null)),U=P.exports,L=r("8c4f"),k=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("section",{staticClass:"section section-home"},[r("div",{staticClass:"container"},[r("div",{staticClass:"columns"},[r("div",{staticClass:"column is-half"},[r("LoginBox")],1),r("div",{staticClass:"column is-half"},[r("RegistrationBox")],1)])])])},_=[],O=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"box"},[r("form-wrapper",{attrs:{validator:e.$v.credentials}},[r("form",{on:{submit:function(t){return t.preventDefault(),e.performLogin(t)}}},[r("form-group",{attrs:{name:"username",label:"Username"}},[r("b-input",{attrs:{type:"username",placeholder:"Username"},on:{input:function(t){return e.$v.credentials.username.$touch()}},model:{value:e.credentials.username,callback:function(t){e.$set(e.credentials,"username",t)},expression:"credentials.username"}})],1),r("form-group",{attrs:{name:"password",label:"Password"}},[r("b-input",{attrs:{type:"password",placeholder:"Password"},on:{input:function(t){return e.$v.credentials.password.$touch()}},model:{value:e.credentials.password,callback:function(t){e.$set(e.credentials,"password",t)},expression:"credentials.password"}})],1),r("div",{staticClass:"field"},[r("button",{staticClass:"button is-primary is-large is-fullwidth",on:{click:e.performLogin}},[e._v("\n          Login\n        ")])]),r("b-message",{attrs:{type:"is-danger","has-icon":"",size:"small",active:e.loginError},on:{"update:active":function(t){e.loginError=t}}},[e._v("\n        The username and/or password was not correct\n      ")])],1)])],1)},j=[],q={methods:{performLoginRequest:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.apiPost("users/login",t);case 2:if(r=e.sent,200!==r.status){e.next=11;break}return this.$ls.set("token",r.data.token),this.$ls.set("user_id",r.data.user_id),this.$ls.set("roles",r.data.roles),this.$eventHub.$emit("login"),e.abrupt("return",!0);case 11:return e.abrupt("return",!1);case 12:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}},E={name:"LoginBox",mixins:[q],data:function(){return{credentials:{username:null,password:null},loginError:!1}},methods:{performLogin:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.$v.credentials.$touch(),!1!==this.$v.credentials.$invalid){e.next=10;break}return this.loginError=!1,e.next=5,this.performLoginRequest(this.credentials);case 5:if(!e.sent){e.next=9;break}this.$router.push({name:"pictures"}),e.next=10;break;case 9:this.loginError=!0;case 10:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},validations:{credentials:{required:p["required"],username:{required:p["required"],minLength:Object(p["minLength"])(3),maxLength:Object(p["maxLength"])(50),alphaNum:p["alphaNum"]},password:{required:p["required"],minLength:Object(p["minLength"])(6),maxLength:Object(p["maxLength"])(50)}}}},C=E,R=Object(h["a"])(C,O,j,!1,null,null,null),H=R.exports,M=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"box"},[r("form-wrapper",{attrs:{validator:e.$v.newUser}},[r("form",{on:{submit:function(t){return t.preventDefault(),e.createAccount(t)}}},[r("form-group",{attrs:{name:"fullname",label:"Full name"}},[r("b-input",{attrs:{type:"username",placeholder:"Full name"},on:{input:function(t){return e.$v.newUser.fullname.$touch()}},model:{value:e.newUser.fullname,callback:function(t){e.$set(e.newUser,"fullname",t)},expression:"newUser.fullname"}})],1),r("form-group",{attrs:{name:"username",label:"Username"}},[r("b-input",{attrs:{type:"username",placeholder:"Username"},on:{input:function(t){return e.$v.newUser.username.$touch()}},model:{value:e.newUser.username,callback:function(t){e.$set(e.newUser,"username",t)},expression:"newUser.username"}})],1),r("form-group",{attrs:{name:"password",label:"Password"}},[r("b-input",{attrs:{type:"password",placeholder:"Password"},on:{input:function(t){return e.$v.newUser.password.$touch()}},model:{value:e.newUser.password,callback:function(t){e.$set(e.newUser,"password",t)},expression:"newUser.password"}})],1),r("form-group",{attrs:{name:"password_confirmation",label:"Password Confirmation"}},[r("b-input",{attrs:{type:"password",placeholder:"Password Confirmation"},on:{input:function(t){return e.$v.newUser.password_confirmation.$touch()}},model:{value:e.newUser.password_confirmation,callback:function(t){e.$set(e.newUser,"password_confirmation",t)},expression:"newUser.password_confirmation"}})],1),r("div",{staticClass:"field"},[r("button",{staticClass:"button is-primary is-large is-fullwidth",on:{click:e.createAccount}},[e._v("\n          Create Account\n        ")])]),r("b-message",{attrs:{type:"is-danger","has-icon":"",size:"small",active:e.accountError},on:{"update:active":function(t){e.accountError=t}}},[e._v("\n        Could not create the account\n      ")])],1)])],1)},A=[],T={name:"RegistrationBox",mixins:[q],data:function(){return{newUser:{fullname:null,username:null,password:null,password_confirmation:null,role:"user"},accountError:!1}},methods:{createAccount:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.$v.newUser.$touch(),!1!==this.$v.newUser.$invalid){e.next=14;break}return this.accountError=!1,e.next=5,this.apiPost("users",this.newUser);case 5:if(t=e.sent,200!==t.status){e.next=13;break}return this.$buefy.snackbar.open("User account created"),e.next=10,this.performLoginRequest({username:this.newUser.username,password:this.newUser.password});case 10:this.$router.push({name:"pictures"}),e.next=14;break;case 13:this.accountError=!0;case 14:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},validations:{newUser:{required:p["required"],fullname:{required:p["required"],minLength:Object(p["minLength"])(6),maxLength:Object(p["maxLength"])(50)},username:{required:p["required"],minLength:Object(p["minLength"])(3),maxLength:Object(p["maxLength"])(50),alphaNum:p["alphaNum"],isUnique:function(e){var t=this;return null===e||e.length<3||new Promise((function(r){t.apiHead("users/"+e).then((function(e){r(404===e.status)}))}))}},password:{required:p["required"],minLength:Object(p["minLength"])(6),maxLength:Object(p["maxLength"])(50)},password_confirmation:{required:p["required"],sameAsPassword:Object(p["sameAs"])("password")}}}},F=T,B=Object(h["a"])(F,M,A,!1,null,null,null),z=B.exports,D={name:"home",components:{RegistrationBox:z,LoginBox:H},created:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.apiGet("pictures");case 2:t=e.sent,console.log(t);case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},N=D,S=Object(h["a"])(N,k,_,!1,null,null,null),G=S.exports;n["a"].use(L["a"]);var I=new L["a"]({mode:"history",base:"/",routes:[{path:"/",name:"home",component:G},{path:"/pictures",name:"pictures",component:function(){return r.e("about").then(r.bind(null,"e1f1"))}},{path:"/pictures/:id",name:"picture",component:function(){return r.e("about").then(r.bind(null,"90ca"))}}]}),J=r("bc3a"),V=r.n(J),W=r("a1bc"),K=r.n(W),Q={methods:{buildApiURL:function(e){return"".concat(K.a.apiProtocol,"://").concat(K.a.apiHost,":").concat(K.a.apiPort,"/").concat(e)},getRequestHeaders:function(e){var t=localStorage.getItem("token");t&&(t=JSON.parse(t).value);var r={Accept:"application/json"};if(null!==t&&t.length>0&&(r["Authorization"]="Bearer "+t),void 0!==e)for(var n in e)e.hasOwnProperty(n)&&(r[n]=e[n]);return r},apiGet:function(e,t){var r=this.getRequestHeaders(t);return this.performRequest(V.a.get,[this.buildApiURL(e),{headers:r}])},apiPost:function(e,t,r){var n=this.getRequestHeaders(r);return this.performRequest(V.a.post,[this.buildApiURL(e),t,{headers:n}])},apiDelete:function(e,t){var r=this.getRequestHeaders(t);return this.performRequest(V.a.delete,[this.buildApiURL(e),{headers:r}])},apiPut:function(e,t,r){var n=this.getRequestHeaders(r);return this.performRequest(V.a.put,[this.buildApiURL(e),t,{headers:n}])},apiHead:function(e,t){var r=this.getRequestHeaders(t);return this.performRequest(V.a.head,[this.buildApiURL(e),{headers:r}])},performRequest:function(e,t){return new Promise((function(r){e.apply(null,t).then(r).catch((function(e){var t={error:e};e.response&&(t=e.response,delete e.response,t.error=e),r(t)}))}))},getAbsoluteURL:function(e){return"/"===e.charAt(0)&&(e=e.substring(1)),"".concat(K.a.apiProtocol,"://").concat(K.a.apiHost,":").concat(K.a.apiPort,"/").concat(e)}}},X=r("c16e"),Y=r.n(X),Z=r("1dce"),ee=r.n(Z),te=r("7f53"),re=r("289d"),ne=(r("5abe"),r("ecee")),ae=(r("2fc4"),r("c074")),se=r("ad3d"),ie=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("b-field",{attrs:{label:e.label,"custom-class":e.customClass,type:e.type,message:e.firstErrorMessage}},[e._t("default")],2)},oe=[],ue={name:"FormGroup",extends:te["b"],computed:{type:function(){return this.hasErrors?"is-danger":this.isValid?"is-success":null},customClass:function(){return this.hasErrors?"has-text-danger":this.isValid?"has-text-success":null}}},ce=ue,le=Object(h["a"])(ce,ie,oe,!1,null,null,null),pe=le.exports;ne["c"].add(ae["g"],ae["h"],ae["o"],ae["l"],ae["k"],ae["d"],ae["c"],ae["b"],ae["a"],ae["p"],ae["i"],ae["m"],ae["n"],ae["e"],ae["f"],ae["s"],ae["j"],ae["q"],ae["r"]),n["a"].component("vue-fontawesome",se["a"]),n["a"].config.productionTip=!1,n["a"].mixin(Q),n["a"].use(Y.a),n["a"].use(re["a"],{defaultIconComponent:"vue-fontawesome",defaultIconPack:"fas"}),n["a"].use(ee.a),n["a"].use(te["a"],{messages:{required:"Field {attribute} is required",email:"Field {attribute} is not a proper email address",minLength:"The value is too short",maxLength:"The value is too long",isUnique:"Username already exists",sameAsPassword:"The passwords do not match"},attributes:{name:"Name",email:"Email",text:"Text"}}),n["a"].component("FormGroup",pe),n["a"].component("formWrapper",te["c"].FormWrapper),n["a"].prototype.$eventHub=new n["a"],new n["a"]({router:I,render:function(e){return e(U)}}).$mount("#app")},"5c0b":function(e,t,r){"use strict";var n=r("e332"),a=r.n(n);a.a},a1bc:function(e,t){var r={apiProtocol:"http",apiHost:"localhost",apiPort:8080};e.exports=r},e332:function(e,t,r){}});
//# sourceMappingURL=app.37ca99c7.js.map